## Project 14: Mini Table Lamp

1.  **Introduction：**

Do you know that the ESP32 can light up an LED when you press a button?
In this project, we will use ESP32、a button switch and an LED to make a
mini table lamp.

2.  **Components：**

<table>
<tbody>
<tr class="odd">
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5012-Keyestudio-ESP32-Learning-Kit-Basic-Edition-Python/master/media/cfb6e37e644d69ddde6ac4e6cb1112f5.jpeg" style="width:1.46736in;height:0.71667in" /></td>
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5012-Keyestudio-ESP32-Learning-Kit-Basic-Edition-Python/master/media/e380dd26e4825be9a768973802a55fe6.png" style="width:0.61597in;height:1.51111in" /></td>
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5012-Keyestudio-ESP32-Learning-Kit-Basic-Edition-Python/master/media/5b8fea4657b47510d199f740fdcaaa9d.png" style="width:1.06736in;height:0.74236in" /></td>
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5012-Keyestudio-ESP32-Learning-Kit-Basic-Edition-Python/master/media/da8a2a9d15baf7280966f3fdbb025a8c.png" style="width:0.26042in;height:1.16667in" /></td>
<td></td>
</tr>
<tr class="even">
<td>ESP32*1</td>
<td>Breadboard*1</td>
<td>Button*1</td>
<td>10KΩ Resistor*1</td>
<td></td>
</tr>
<tr class="odd">
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5012-Keyestudio-ESP32-Learning-Kit-Basic-Edition-Python/master/media/ef77f5a64c382157fc2dea21ec373fef.png" style="width:0.29514in;height:1.25903in" /></td>
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5012-Keyestudio-ESP32-Learning-Kit-Basic-Edition-Python/master/media/845d05a6108b1662b828610ba9dcb788.png" style="width:0.25833in;height:1.13681in" /></td>
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5012-Keyestudio-ESP32-Learning-Kit-Basic-Edition-Python/master/media/7dcbd02995be3c142b2f97df7f7c03ce.png" style="width:1.05903in;height:0.56667in" /></td>
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5012-Keyestudio-ESP32-Learning-Kit-Basic-Edition-Python/master/media/e9a8d050105397bb183512fb4ffdd2f6.png" style="width:0.8375in;height:0.83194in" /></td>
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5012-Keyestudio-ESP32-Learning-Kit-Basic-Edition-Python/master/media/9cab81f7da18c7b0c245ec2a2f614f3a.png" style="width:0.84514in;height:0.83264in" /></td>
</tr>
<tr class="even">
<td>Red LED*1</td>
<td>220Ω Resistor*1</td>
<td>USB Cable*1</td>
<td>Jumper Wires</td>
<td>Button Cap*1</td>
</tr>
</tbody>
</table>

**3. Component knowledge：**

![](/media/5b8fea4657b47510d199f740fdcaaa9d.png)

**Button:** A button can control the circuit on and off, the button is
plugged into a circuit, the circuit is disconnected when the button is
not pressed. The circuit works when you press the button, but breaks
again when you release it. Why does it only work when you press it? It
starts from the internal structure of the button, which don’t allow
current to travel from one end of the button to the other before it is
pressed; When pressed, a metal strip inside the button connects the two
sides to allow electricity to pass through.

The internal structure of the button is shown in the
figure：![](/media/d2a204e61c768f18924150db58aee093.png). Before the button is pressed, 1 and 2
are on, 3 and 4 are also on, but 1, 3 or 1, 4 or 2, 3 or 2, 4 are off
(not working). Only when the button is pressed, 1, 3 or 1, 4 or 2, 3 or
2, 4 are on.

The button switch is one of the most commonly used components in circuit
design.

**Schematic diagram of the button:**

![](/media/5e42fde9876f9be810d85a7fb8b331f7.png)
![](/media/8677548f9e756281629430d66ba3a460.png)

**What is button** **[shake](javascript:;)?**

We think of the switch circuit as "press the button and turn it on
immediately", "press it again and turn it off immediately". In fact,
this is not the case.

The button usually uses a mechanical elastic switch, and the mechanical
elastic switch will produce a series of [shake](javascript:;) due to the
elastic action at the moment when the mechanical contact is opened and
closed (usually about 10ms). As a result, the button switch will not
immediately and stably turn on the circuit when it is closed, and it
will not be completely and instantaneously disconnected when it is
turned off.

![](/media/7e7ac82db8bb810a7ee1de4181ceaa2d.jpeg)

**How to eliminate the** **[shake](javascript:;)?**

There are two common methods, namely fix [shake](javascript:;) in the
software and hardware. We only discuss the [shake](javascript:;) removal
in the software.

We already know that the [shake](javascript:;) time generated by
elasticity is about 10ms, and the delay command can be used to delay the
execution time of the command to achieve the effect of
[shake](javascript:;) removal.

Therefore, we delay 0.02s in the code to achieve the key anti-shake
function.

![](/media/c0d68d1134b0b4097e8983ed2cac07fc.jpeg)

**4. Wiring Diagram：**

![](/media/a5b85f1e1f5714afbe4730b1265e3a15.png)

**Note:**

How to connect the LED

![](/media/f70404aa49540fd7aecae944c7c01f83.jpeg)

How to identify the 220Ω 5-band resistor and 10KΩ 5-band resistor

![](/media/55c0199544e9819328f6d5778f10d7d0.png)

![](/media/246cf3885dc837c458a28123885c9f7b.png)

5.  **Project code：**

Codes used in this tutorial are saved in“4. Python Tutorial\\2. Python
Projects”. You can move the codes to any location. For example, we save
the codes in Disk(D) with the path of“D:\\2. Python Projects”.

![](/media/906b7d4391131929a6b0726f7f5bab30.png)

Open“Thonny”，click“This computer”→“D:”→“2. Python Projects”→”Project 14:
Mini Table Lamp”, and then double left-click
“Project\_14\_Mini\_Table\_Lamp.py”.

![](/media/28442295ad614f1049647b5692599350.png)

<table>
<tbody>
<tr class="odd">
<td><p>from machine import Pin</p>
<p>import time</p>
<p>led = Pin(4, Pin.OUT) # create LED object from Pin 4,Set Pin 4 to output</p>
<p>button = Pin(15, Pin.IN, Pin.PULL_UP) #Create button object from Pin15,Set GP15 to input</p>
<p>#Customize a function and name it reverseGPIO(),which reverses the output level of the LED</p>
<p>def reverseGPIO():</p>
<p>if led.value():</p>
<p>led.value(0) #Set led turn off</p>
<p>else:</p>
<p>led.value(1) #Set led turn on</p>
<p>try:</p>
<p>while True:</p>
<p>if not button.value():</p>
<p>time.sleep_ms(20)</p>
<p>if not button.value():</p>
<p>reverseGPIO()</p>
<p>while not button.value():</p>
<p>time.sleep_ms(20)</p>
<p>except:</p>
<p>pass</p></td>
</tr>
</tbody>
</table>

6.  **Project result：**
    
    Make sure the ESP32 has been connected to the computer,
    click![](/media/27451c8a9c13e29d02bc0f5831cfaf1f.png)“Stop/Restart backend” .

![](/media/e5db97bc2223667744a3ade3a7a6a254.png)

Click ![](/media/da852227207616ccd9aff28f19e02690.png)“Run current script”, the code starts to be
executed and you'll see that press the push button switch, the LED turns
on; When it is released, the LED is still on. Press it again, and the
LED turns off. When it is released, the LED stays off. Doesn't it look
like a mini table lamp? Press“Ctrl+C”or
click![](/media/27451c8a9c13e29d02bc0f5831cfaf1f.png)“Stop/Restart backend”to exit the program.

![](/media/0e8007a8ff9ad4b13de3c30c55ec3e7f.png)
